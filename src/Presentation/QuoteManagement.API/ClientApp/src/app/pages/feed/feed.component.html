<div class="feed-container">
  <div class="card mb-4">
    <div class="font-semibold text-2xl mb-4 text-center">📚 Alıntılar</div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading">
    <div class="card mb-4" *ngFor="let item of [1,2,3]">
      <div class="font-semibold text-xl mb-4">Quote Loading...</div>
      <div class="rounded-border border border-surface p-4">
        <div class="flex mb-4">
          <p-skeleton shape="circle" size="4rem" styleClass="mr-3"></p-skeleton>
          <div class="flex-1">
            <p-skeleton width="10rem" styleClass="mb-2"></p-skeleton>
            <p-skeleton width="5rem" styleClass="mb-2"></p-skeleton>
            <p-skeleton height=".5rem"></p-skeleton>
          </div>
        </div>
        <p-skeleton width="100%" height="80px" styleClass="mb-4"></p-skeleton>
        <div class="flex justify-between">
          <p-skeleton width="6rem" height="2rem"></p-skeleton>
          <p-skeleton width="4rem" height="2rem"></p-skeleton>
        </div>
      </div>
    </div>
  </div>

  <!-- Quotes Feed -->
  <div *ngIf="!loading">
    <div class="card mb-4" *ngFor="let quote of quotes; let i = index">
      <div class="flex align-items-center mb-3">
        <i class="pi pi-quote-left text-primary mr-2"></i>
        <span class="font-semibold text-lg">Quote</span>
      </div>
      
      <div class="border border-surface rounded-border p-4">
        <!-- User Info -->
        <div class="flex align-items-center mb-4">
          <p-avatar 
            [image]="quote.userAvatar" 
            size="large" 
            shape="circle" 
            styleClass="mr-3">
          </p-avatar>
          <div>
            <div class="font-semibold text-lg">{{ quote.userName }}</div>
            <div class="text-sm text-500 mb-1">{{ quote.userNickname }}</div>
            <div class="text-xs text-400">{{ quote.datePosted | date:'short' }}</div>
          </div>
        </div>

        <!-- Quote Content -->
        <div class="quote-content mb-4">
          <blockquote class="border-left-3 border-primary pl-4 italic text-lg line-height-3 my-4 mb-6">
            "{{ quote.quoteText }}"
          </blockquote>
          
          <!-- Book Cover and Tags -->
          <div class="flex gap-3 mb-3 mt-4">
            <div class="flex-shrink-0">
              <img 
                [src]="quote.bookCoverUrl || '/demo/images/ecommerce/blue-book.jpg'" 
                [alt]="quote.bookName"
                class="w-16 h-20 object-cover rounded shadow-sm border border-surface-200"
                (error)="onImageError($event)"
              />
            </div>
            <div class="flex flex-wrap gap-2 align-items-start flex-1">
              <p-tag 
                [value]="'📖 ' + quote.bookName" 
                severity="info" 
                styleClass="text-sm">
              </p-tag>
              <p-tag 
                [value]="'✍️ ' + quote.author" 
                severity="secondary" 
                styleClass="text-sm">
              </p-tag>
              <p-tag 
                [value]="quote.genre" 
                severity="success" 
                styleClass="text-sm"
                *ngIf="quote.genre">
              </p-tag>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-between align-items-center">
          <div class="flex gap-2">
            <p-button 
              icon="pi pi-heart" 
              [label]="quote.likes.toString()" 
              severity="secondary" 
              size="small"
              [outlined]="!quote.isLiked"
              (click)="toggleLike(i)"
              styleClass="quote-action-btn">
            </p-button>
            
            <p-button 
              icon="pi pi-bookmark" 
              severity="secondary" 
              size="small"
              [outlined]="!quote.isBookmarked"
              (click)="toggleBookmark(i)"
              styleClass="quote-action-btn">
            </p-button>
          </div>
          
          <div class="flex gap-2">
            <p-button 
              icon="pi pi-copy" 
              severity="secondary" 
              size="small" 
              outlined
              (click)="copyQuote(quote.quoteText)"
              pTooltip="Copy quote"
              tooltipPosition="top">
            </p-button>
            
            <p-button 
              icon="pi pi-share-alt" 
              severity="secondary" 
              size="small" 
              outlined
              (click)="shareQuote(quote)"
              pTooltip="Share quote"
              tooltipPosition="top">
            </p-button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && quotes.length === 0" class="card text-center p-6">
    <i class="pi pi-book text-6xl text-300 mb-4"></i>
    <h3 class="text-xl font-semibold mb-2">No quotes yet</h3>
    <p class="text-500">Start sharing your favorite book quotes!</p>
  </div>
</div>

<p-toast></p-toast>